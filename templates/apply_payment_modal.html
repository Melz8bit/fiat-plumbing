<div class="modal-dialog modal-lg">
    <div class="modal-content">
        <div class="modal-header">
            <h1 class="modal-title fs-5">Apply Payment</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form id="applyPayment" name="applyPayment" method="POST">
            {{ apply_payment_form.csrf_token() }}
            <div class="modal-body">
                <!-- Payment Information -->
                <h6>Payment Information</h6>
                <div>
                    <div class="row">
                        <div class="input-group mb-3 col">
                            {{ apply_payment_form.payment_method.label(class="input-group-text w-50") }}
                            {{ apply_payment_form.payment_method(class="form-select") }}
                        </div>
                        <div class="input-group mb-3 col">
                            {{ apply_payment_form.check_number.label(class="input-group-text w-50") }}
                            {{ apply_payment_form.check_number(class="form-control") }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-group mb-3 col">
                            {{ apply_payment_form.payment_amount.label(class="input-group-text w-50") }}
                            <span class="input-group-text">$</span>
                            {{ apply_payment_form.payment_amount(class="form-control", min="0") }}
                        </div>
                        <div class="input-group mb-3 col">
                            {{ apply_payment_form.date_received.label(class="input-group-text w-50") }}
                            {{ apply_payment_form.date_received(class="form-control") }}
                        </div>
                    </div>
                </div>
                <h6>Select invoices:</h6>
                <table class="table">
                    <thead class="text-center">
                        <th></th>
                        <th>#</th>
                        <th>Created Date</th>
                        <th>Invoice Amount</th>
                    </thead>
                    <tbody>
                        {% if open_invoices|length == 0 %}
                        <tr>
                            <td class="text-center" colspan="100%">
                                No billable invoices found on this project
                            </td>
                        </tr>
                        {% else %}
                        {% for invoice in open_invoices %}
                        <tr class="text-center align-items-center">
                            <td>{{ apply_payment_form.invoice_select(
                                class="is-valid",
                                id="invoiceChkMk"+invoice['invoice_id']|string ,
                                value=invoice['invoice_id'],
                                ) }} </td>
                            <td>{{ invoice['invoice_number'] }}</td>
                            <td>{{ invoice['created_date'].strftime('%m/%d/%Y') }}</td>
                            <td>{{ "${:,.2f}".format(invoice['invoice_amount']) }}</td>
                        </tr>
                        {% endfor %}
                        {% endif %}
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="100%">
                                <div class="input-group mb-3">
                                    {{ apply_payment_form.payment_note.label(class="input-group-text") }}
                                    {{ apply_payment_form.payment_note(class="form-control") }}
                                </div>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col">
                        <div id="validationSelectInstallment" class="invalid-feedback" style="display: none;">
                            Please choose at least one installment.
                        </div>
                    </div>
                    <div class="col">
                        {{ invoice_create_form.create(class="btn btn-primary") }}
                    </div>
                </div>
            </div>
        </form>
        <!-- <script>
            // Example starter JavaScript for disabling form submissions if there are invalid fields
            (() => {
                'use strict'

                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                const forms = document.querySelectorAll('.needs-validation')

                // Loop over them and prevent submission
                Array.from(forms).forEach(form => {
                    form.addEventListener('submit', event => {
                        if (!form.checkValidity()) {
                            event.preventDefault()
                            event.stopPropagation()
                        }

                        form.classList.add('was-validated')
                    }, false)
                })
            })()
        </script>
        <script>
            // Select all checkboxes with the name 'settings' using querySelectorAll.
            var checkboxes = document.querySelectorAll("input[type=checkbox]");

            // Use Array.forEach to add an event listener to each checkbox.
            checkboxes.forEach(function (checkbox) {
                checkbox.addEventListener('change', function () {
                    document.getElementById("installmentBillledPercent" + checkbox.value).disabled = !checkbox.checked;
                })
            });
        </script> -->
    </div>
</div>